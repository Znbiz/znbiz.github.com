(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(window.jQuery)})(function(e){function t(e,t){var r,n=e.data,s=e.stamp;switch(typeof t){case"boolean":r=t;break;case"function":r=!!t(n,s);break;case"object":r=+t>o();break;case"number":r=s>o()-t;break;default:throw"Invalid `cached` option value. Expected Number, Boolean, Function or Date, but got "+t}return r?n:null}function r(e,t){return{response:t,responseText:e.responseText,responseXML:e.responseXML,readyState:e.readyState,status:e.status,statusText:e.statusText,responseHeaders:e.getAllResponseHeaders()}}function n(t){var r,n=e.Deferred(),o={},a=t.responseHeaders,c=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm;return s("setRequestHeader overrideMimeType statusCode abort",function(t){o[t]=e.noop}),s("responseText responseXML readyState status statusText",function(e){o[e]=t[e]}),o.getAllResponseHeaders=function(){return a},o.getResponseHeader=function(e){var t;if(!r)for(r={};t=c.exec(a);)r[t[1].toLowerCase()]=t[2];return t=r[e.toLowerCase()],t||null},n.resolve(t.response,t.statusText).promise(o),o.success=o.done,o.error=o.fail,o.complete=o.always,o}function o(){return+new Date}function s(t,r){e.each(t.split(" "),function(e,t){r(t)})}function a(e,t){throw t=t||{},e=e.replace(/\{([^{}]+)\}/g,function(e,r){return t[r]}),Error("$.ajax.goodies: "+e)}function c(e){return[e.type,e.url,e.data].join(":").toLowerCase()}function u(e,t){d.concurrents[e]=t,t.always(function(){delete d.concurrents[e]})}function i(e){var t=e.concurrency;return t&&{type:"string"==typeof t?t:t.type,key:t.key||c(e)}}var d=e.ajax.goodies={version:"0.3.1",concurrents:{}};d.cached={setAdapter:function(e){s("setItem getItem removeItem",function(t){e[t]||a('Method "{method}" is not implemented in adapter',{method:t})}),this._adapter=e},getAdapter:function(){return this._adapter||a("Adapter does not defined")}},d.cached.setAdapter({storage:{},setItem:function(e,t){this.storage[e]=t},getItem:function(e){return this.storage[e]},removeItem:function(e){delete this.storage[e]}}),e.ajaxPrefilter(function(s,a,u){if(s.cached){var i=c(s),f=d.cached.getAdapter(),p=f.getItem(i),l=p&&t(p,s.cached);if(l){u.abort();var m=n(l);e.extend(u,m),u.then(s.success,s.error).always(s.complete)}else p&&f.removeItem(i),u.success(function(e){f.setItem(i,{data:r(u,e),stamp:o()})})}}),e.ajaxPrefilter(function(e,t,r){var n,o,s=i(e);if(s)if(n=s.key,o=d.concurrents[n])switch(s.type){case"suppress":o.abort(),u(n,r);break;case"abort":r.abort();break;default:throw"Unsupported $.ajax.concurrents type: "+s.type}else u(n,r)})});